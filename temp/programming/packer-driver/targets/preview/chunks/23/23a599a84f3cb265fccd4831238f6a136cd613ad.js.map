{"version":3,"sources":["file:///Users/takeda.naomichi/Desktop/QuizTestProject/assets/Script/Game/Quiz/GestureQuiz.ts"],"names":["_decorator","math","GameManager","QuizModalManager","QuizDataBase","QuizComponent","ccclass","property","GestureQuiz","mSprite","mData","debugClientMode","start","update","deltaTime","DebugClientMode","SetQuiz","Instance","GetData","DecisionAnswer","GetGameInfo","qNumber","mNumber","GetClientMode","mSentence","qSentence","qAnswer","mAnswer","qSprite","GetQuestionModal","SetNumber","SetSentence","SetSprite","GetChoicesModal","SetQuestion","temp","i","select","SetChoices","mIndex","tempdata","result","n","length","GetResultModal","SetAnswerLabel","SetAnswerSprite","Initialize","Reset","mType","count","GetDataList","randomRangeInt"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAA0CC,MAAAA,I,OAAAA,I;;AAC9BC,MAAAA,W,iBAAAA,W;;AACZC,MAAAA,gB,iBAAAA,gB;;AAEAC,MAAAA,Y,iBAAAA,Y;;AACAC,MAAAA,a,iBAAAA,a;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBP,U;;6BAKjBQ,W,WADZF,OAAO,CAAC,aAAD,C,gBAAR,MACaE,WADb;AAAA;AAAA,0CAC+C;AAAA;AAAA;AAAA,eAE3CC,OAF2C;AAAA,eAG3CC,KAH2C;AAAA,eAKnCC,eALmC,GAKJ,OALI;AAAA;;AAO3CC,QAAAA,KAAK,GAAG,CAEP;;AAEDC,QAAAA,MAAM,CAACC,SAAD,EAAoB;AACtB,eAAKC,eAAL;AACH;;AAEMC,QAAAA,OAAO,GAAE;AAEZ;AACA,eAAKN,KAAL,GAAa;AAAA;AAAA,4CAAaO,QAAb,GAAwBC,OAAxB,CAA6C,SAA7C,EAAwD,KAAKC,cAAL,EAAxD,CAAb;AACA;AAAA;AAAA,0CAAYF,QAAZ,GAAuBG,WAAvB,GAAqCC,OAArC,GAA+C,KAAKC,OAApD;;AACA,cAAG;AAAA;AAAA,0CAAYL,QAAZ,GAAuBM,aAAvB,OAA2C,OAA9C,EAAsD;AAAC,iBAAKC,SAAL,GAAiB,aAAjB;AAAgC,WAAvF,MACI;AAAC,iBAAKA,SAAL,GAAiB,iBAAjB;AAAoC;;AACzC;AAAA;AAAA,0CAAYP,QAAZ,GAAuBG,WAAvB,GAAqCK,SAArC,GAAiD,KAAKD,SAAtD;AACA;AAAA;AAAA,0CAAYP,QAAZ,GAAuBG,WAAvB,GAAqCM,OAArC,GAA+C,KAAKhB,KAAL,CAAWiB,OAA1D;AACA;AAAA;AAAA,0CAAYV,QAAZ,GAAuBG,WAAvB,GAAqCQ,OAArC,GAA+C,KAAKlB,KAAL,CAAWD,OAA1D;AAEA,eAAKC,KAAL,CAAWiB,OAAX,GAAqB;AAAA;AAAA,0CAAYV,QAAZ,GAAuBG,WAAvB,GAAqCM,OAA1D;AACA,eAAKhB,KAAL,CAAWD,OAAX,GAAqB;AAAA;AAAA,0CAAYQ,QAAZ,GAAuBG,WAAvB,GAAqCQ,OAA1D,CAZY,CAcZ;;AACA;AAAA;AAAA,oDAAiBX,QAAjB,GAA4BY,gBAA5B,GAA+CC,SAA/C,CAAyD,EAAE;AAAA;AAAA,0CAAYb,QAAZ,GAAuBG,WAAvB,GAAqCC,OAAhG;AACA;AAAA;AAAA,oDAAiBJ,QAAjB,GAA4BY,gBAA5B,GAA+CE,WAA/C,CAA2D;AAAA;AAAA,0CAAYd,QAAZ,GAAuBG,WAAvB,GAAqCK,SAAhG;AACA;AAAA;AAAA,oDAAiBR,QAAjB,GAA4BY,gBAA5B,GAA+CG,SAA/C,CAAyD,KAAKvB,OAAL,GAAe,KAAKC,KAAL,CAAWD,OAAnF,EAjBY,CAqBZ;;AACA;AAAA;AAAA,oDAAiBQ,QAAjB,GAA4BgB,eAA5B,GAA8CC,WAA9C,CAA0D,YAA1D;AACA,cAAIC,IAAoB,GAAG,CAAC,CAAC,CAAF,EAAI,CAAC,CAAL,EAAO,CAAC,CAAR,EAAU,CAAC,CAAX,EAAa,CAAC,CAAd,EAAgB,CAAC,CAAjB,CAA3B;;AACA,eAAI,IAAIC,CAAU,GAAG,CAArB,EAAwBA,CAAC,GAAG,CAA5B,EAA+BA,CAAC,EAAhC,EAAmC;AAC/B,gBAAIC,MAAJ;;AACA,gBAAGD,CAAC,KAAK,CAAT,EAAW;AAACC,cAAAA,MAAM,GAAG,IAAT;AAAe,aAA3B,MACK,IAAGD,CAAC,KAAK,CAAT,EAAW;AAACC,cAAAA,MAAM,GAAG,IAAT;AAAe,aAA3B,MACA,IAAGD,CAAC,KAAK,CAAT,EAAW;AAACC,cAAAA,MAAM,GAAG,IAAT;AAAe,aAA3B,MACA,IAAGD,CAAC,KAAK,CAAT,EAAW;AAACC,cAAAA,MAAM,GAAG,IAAT;AAAe,aAA3B,MACA,IAAGD,CAAC,KAAK,CAAT,EAAW;AAACC,cAAAA,MAAM,GAAG,IAAT;AAAe,aAA3B,MACA,IAAGD,CAAC,KAAK,CAAT,EAAW;AAACC,cAAAA,MAAM,GAAG,IAAT;AAAe;;AAEhC,gBAAGD,CAAC,KAAK,KAAK1B,KAAL,CAAWiB,OAApB,EAA4B;AACxB;AAAA;AAAA,wDAAiBV,QAAjB,GAA4BgB,eAA5B,GAA8CK,UAA9C,CAAyDF,CAAzD,EAA4DC,MAA5D,EAAoE,KAAK3B,KAAL,CAAWD,OAA/E;AACA0B,cAAAA,IAAI,CAACC,CAAD,CAAJ,GAAU,KAAK1B,KAAL,CAAW6B,MAArB;AACH,aAHD,MAII;AACA,kBAAIC,QAAsB,GAAG,IAA7B;;AACA,iBAAG;AACCA,gBAAAA,QAAQ,GAAG;AAAA;AAAA,kDAAavB,QAAb,GAAwBC,OAAxB,CAA6C,SAA7C,EAAwD,KAAKC,cAAL,EAAxD,CAAX;AACA,oBAAIsB,MAAgB,GAAG,KAAvB;;AACA,qBAAI,IAAIC,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAGP,IAAI,CAACQ,MAAxB,EAAgCD,CAAC,EAAjC,EAAoC;AAChC,sBAAGF,QAAQ,CAACD,MAAT,KAAoB,KAAK7B,KAAL,CAAW6B,MAA/B,IAAyCJ,IAAI,CAACO,CAAD,CAAJ,KAAYF,QAAQ,CAACD,MAAjE,EAAwE;AACpEE,oBAAAA,MAAM,GAAG,KAAT;AACA;AACH;;AAED,sBAAGN,IAAI,CAACO,CAAD,CAAJ,KAAY,CAAC,CAAhB,EAAkB;AACdP,oBAAAA,IAAI,CAACO,CAAD,CAAJ,GAAUF,QAAQ,CAACD,MAAnB;AACAE,oBAAAA,MAAM,GAAG,IAAT;AACA;AACH;AACJ;AACJ,eAfD,QAeS,CAACA,MAfV;;AAiBA;AAAA;AAAA,wDAAiBxB,QAAjB,GAA4BgB,eAA5B,GAA8CK,UAA9C,CAAyDF,CAAzD,EAA4DC,MAA5D,EAAoEG,QAAQ,CAAC/B,OAA7E;AACH;AACJ,WA1DW,CA4DZ;;;AACA;AAAA;AAAA,oDAAiBQ,QAAjB,GAA4B2B,cAA5B,GAA6CC,cAA7C,CAA4D,KAAKnC,KAAL,CAAWiB,OAAvE,EAAgF,EAAhF;AACA;AAAA;AAAA,oDAAiBV,QAAjB,GAA4B2B,cAA5B,GAA6CE,eAA7C,CAA6D,KAAKrC,OAAlE;AACH;;AAEMsC,QAAAA,UAAU,GAAE;AACf,gBAAMC,KAAN;AACA;AAAA;AAAA,oDAAiB/B,QAAjB,GAA4BY,gBAA5B,GAA+CkB,UAA/C,CAA0D,KAAKE,KAAL,GAAa,SAAvE;AACA,eAAKxC,OAAL,GAAe,IAAf,CAHe,CAGO;;AACtB,eAAKC,KAAL,GAAa,IAAb;AACH;;AAEOS,QAAAA,cAAc,GAAW;AAC7B,cAAI+B,KAAK,GAAG;AAAA;AAAA,4CAAajC,QAAb,GAAwBkC,WAAxB,CAAiD,SAAjD,EAA4DR,MAAxE;AACA,iBAAO1C,IAAI,CAACmD,cAAL,CAAoB,CAApB,EAAuBF,KAAvB,CAAP;AACH,SA1F0C,CA4F3C;AACA;AACA;;;AAEQnC,QAAAA,eAAe,GAAE;AACrB,cAAG;AAAA;AAAA,0CAAYE,QAAZ,GAAuBM,aAAvB,MAA0C,KAAKZ,eAAlD,EAAkE;AAC9D,gBAAG;AAAA;AAAA,4CAAYM,QAAZ,GAAuBM,aAAvB,OAA2C,OAA9C,EAAsD;AAClD,mBAAKC,SAAL,GAAiB,aAAjB;AACA,mBAAKb,eAAL,GAAuB,OAAvB;AACH,aAHD,MAII;AACA,mBAAKa,SAAL,GAAiB,eAAjB;AACA,mBAAKb,eAAL,GAAuB,MAAvB;AACH;;AACD;AAAA;AAAA,sDAAiBM,QAAjB,GAA4BY,gBAA5B,GAA+CE,WAA/C,CAA2D,KAAKP,SAAhE;AACH;AACJ;;AA5G0C,O","sourcesContent":["import { _decorator, Component, Node, SpriteFrame, math, SphereColliderComponent } from 'cc';\nimport { ClientMode, GameManager } from '../Manager/GameManager';\nimport { QuizModalManager } from '../Manager/QuizModalManager';\nimport { GestureData } from './Data/QuizData';\nimport { QuizDataBase } from './Data/QuizDataBase';\nimport { QuizComponent } from './QuizComponent';\nconst { ccclass, property } = _decorator;\n\n\n\n@ccclass('GestureQuiz')\nexport class GestureQuiz extends QuizComponent {\n\n    mSprite : SpriteFrame;  // 問題の画像\n    mData : GestureData;\n\n    private debugClientMode : ClientMode = 'Liver';\n\n    start() {\n\n    }\n\n    update(deltaTime: number) {\n        this.DebugClientMode();\n    }\n\n    public SetQuiz(){\n\n        // デバッグ用(本当はサーバーからもらってくる)\n        this.mData = QuizDataBase.Instance().GetData<GestureData>('Gesture', this.DecisionAnswer());\n        GameManager.Instance().GetGameInfo().qNumber = this.mNumber;\n        if(GameManager.Instance().GetClientMode() === 'Liver'){this.mSentence = \"この顔を演じてください\";}\n        else{this.mSentence = \"どの顔文字を演じているでしょう\";}\n        GameManager.Instance().GetGameInfo().qSentence = this.mSentence;\n        GameManager.Instance().GetGameInfo().qAnswer = this.mData.mAnswer;\n        GameManager.Instance().GetGameInfo().qSprite = this.mData.mSprite;\n\n        this.mData.mAnswer = GameManager.Instance().GetGameInfo().qAnswer;\n        this.mData.mSprite = GameManager.Instance().GetGameInfo().qSprite;\n\n        // 問題文\n        QuizModalManager.Instance().GetQuestionModal().SetNumber(++GameManager.Instance().GetGameInfo().qNumber);\n        QuizModalManager.Instance().GetQuestionModal().SetSentence(GameManager.Instance().GetGameInfo().qSentence);\n        QuizModalManager.Instance().GetQuestionModal().SetSprite(this.mSprite = this.mData.mSprite);\n\n\n\n        // 選択肢\n        QuizModalManager.Instance().GetChoicesModal().SetQuestion(\"どの顔を演じている?\");\n        var temp : Array<number> = [-1,-1,-1,-1,-1,-1];\n        for(var i : number = 0; i < 6; i++){\n            var select : string;\n            if(i === 0){select = \"A.\";}\n            else if(i === 1){select = \"B.\";}\n            else if(i === 2){select = \"C.\";}\n            else if(i === 3){select = \"D.\";}\n            else if(i === 4){select = \"E.\";}\n            else if(i === 5){select = \"F.\";}\n\n            if(i === this.mData.mAnswer){\n                QuizModalManager.Instance().GetChoicesModal().SetChoices(i, select, this.mData.mSprite);\n                temp[i] = this.mData.mIndex;\n            }\n            else{\n                var tempdata : GestureData = null\n                do {\n                    tempdata = QuizDataBase.Instance().GetData<GestureData>('Gesture', this.DecisionAnswer());\n                    var result : Boolean = false;\n                    for(var n = 0; n < temp.length; n++){\n                        if(tempdata.mIndex === this.mData.mIndex || temp[n] === tempdata.mIndex){\n                            result = false;\n                            break;\n                        }\n\n                        if(temp[n] === -1){\n                            temp[n] = tempdata.mIndex;\n                            result = true;\n                            break;\n                        }\n                    }\n                } while (!result);\n\n                QuizModalManager.Instance().GetChoicesModal().SetChoices(i, select, tempdata.mSprite);\n            }\n        }\n\n        // 結果\n        QuizModalManager.Instance().GetResultModal().SetAnswerLabel(this.mData.mAnswer ,\"\");\n        QuizModalManager.Instance().GetResultModal().SetAnswerSprite(this.mSprite);        \n    }\n\n    public Initialize(){\n        super.Reset();\n        QuizModalManager.Instance().GetQuestionModal().Initialize(this.mType = 'Gesture');\n        this.mSprite = null;  // 問題の画像\n        this.mData = null;\n    }\n\n    private DecisionAnswer() : number{\n        var count = QuizDataBase.Instance().GetDataList<GestureData>('Gesture').length;\n        return math.randomRangeInt(0, count);\n    }\n\n    // public GetData() : GestureData{\n    //     return this.mData;\n    // }\n\n    private DebugClientMode(){\n        if(GameManager.Instance().GetClientMode() != this.debugClientMode){\n            if(GameManager.Instance().GetClientMode() === 'Liver'){\n                this.mSentence = \"この顔を演じてください\";\n                this.debugClientMode = 'Liver';\n            }\n            else{\n                this.mSentence = \"どの顔を演じているでしょう\";\n                this.debugClientMode = 'User';\n            }\n            QuizModalManager.Instance().GetQuestionModal().SetSentence(this.mSentence);\n        }\n    }\n}\n\n"]}